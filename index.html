<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Using Best-of-N Sampling as Initialization for Verbalized Machine Learning Generates Better World Models for Task Planning">
  <meta name="keywords" content="LLM, Verbalized Machine Learning, PDDL">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Verbalized Machine Learning with Best-of-N Sampling
    Generates Better World Models for Task Planning</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/robot-svgrepo-com.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Verbalized Machine Learning with Best-of-N Sampling
            Generates Better World Models for Task Planning</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.google.com/citations?view_op=list_works&hl=en&hl=en&user=qUMjnPcAAAAJ" style="text-decoration: none; color: inherit;">Zhouliang Yu<sup style="color:#ed4b82;">*</sup><sup style="color:#6fbf73;">1</sup></a>,
            </span>
            <span class="author-block">
              <a href="https://openreview.net/profile?id=~Yuhuan_Yuan1" style="text-decoration: none; color: inherit;">Yuhuan Yuan<sup style="color:#ed4b82;">*</sup><sup style="color:#6fbf73;">2</sup></a>
              ,
            </span>
            <span class="author-block">
              <a href="https://timx.me/" style="text-decoration: none; color: inherit;">Tim Z. Xiao<sup style="color:#6fbf73;">3</sup></a>
              ,
            </span>
            <span class="author-block">
              <a href="" style="text-decoration: none; color: inherit;">Fuxiang Frank Xia<sup style="color:#ed4b82;">4</sup></a>
              ,
          </span>
          <span class="author-block">
              <a href="https://bigaidream.github.io/" style="text-decoration: none; color: inherit;">Jie Fu<sup style="color:#9b51e0;"></sup><sup style="color:#6fbf73;">5</sup></a>
              ,
          </span>
          <span class="author-block">
              <a href="https://scholar.google.com/citations?user=qyTrq4kAAAAJ&hl=zh-CN" style="text-decoration: none; color: inherit;">Ge Zhang<sup style="color:#ffac33;">6</sup><sup style="color:#6fbf73;">7</sup></a>
          </span>
          <br>
          <span class="author-block">
              <a href="https://facultyprofiles.hkust-gz.edu.cn/faculty-personal-page/KAN-GeLin/gelin" style="text-decoration: none; color: inherit;">Ge Lin<sup style="color:#ffac33;">2<sup style="color:#9b51e0;">†</sup></a>
          </span>
          <span class="author-block">
              <a href="https://wyliu.com/" style="text-decoration: none; color: inherit;">Weiyang Liu<sup style="color:#ffac33;">3</sup><sup style="color:#9b51e0;">†</sup></a>
              ,
          </span>
          </div>
    
          <br>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>The Chinese University of Hong Kong,</span>
            <span class="author-block"><sup>2</sup>The Hong Kong University of Science and Technology (Guangzhou),</span>
            <span class="author-block"><sup>3</sup>Max Planck Institute for Intelligent Systems -- Tübingen,</span>
            <span class="author-block"><sup>4</sup>Environmental Systems Research Institute,</span>
            <span class="author-block"><sup>5</sup>Shanghai Artificial Intelligence Laboratory,</span>
            <span class="author-block"><sup>6</sup>M-A-P,</span>
            <span class="author-block"><sup>7</sup>Bytedance,</span>
            <br>
            <span class="author-block"><sup style="color:#ed4b82;">*</sup>Equal contribution,</span>
            <span class="author-block"><sup style="color:#9b51e0;">†</sup>Corresponding author</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="./static/images/pddl_pipeline.png" alt="The Pipeline of our method" width="100%"/>
      <h2 class="subtitle has-text-centered">
        <span class="dnerf">VML with BoN Sampling for PDDL Domain Generation</span>
        We adopt formal language-PDDL as an intermediate abstraction for planning. 
        The upper domain generation process shows how we generate an error-free and logically correct PDDL domain, which involves reducing the search space by focusing LLMs on predicates and actions.
        We employ BoN sampling to consider multiple possible domain actions simultaneously.
        We then use verbalized machine learning to iteratively refine and improve the sampled domains in the text space.
        The downward planning blocks show how we generate the plan. 
       Once we have a synthetic PDDL domain that passes PDDL grammar checks, we combine it with a PDDL problem, then leverage searching algorithms such as  A$\ast$ to search for the optimal plan.
      </h2>
    </div>
  </div>
</section> -->
<section class="hero teaser"></section>
  <div class="container is-max-desktop">
        <div class="content has-text-centered">
          <img src="./static/images/pddl_pipeline.png" alt="The Pipeline of our method" width="100%"/>
          <p>We adopt formal language-PDDL as an intermediate abstraction for planning. 
            The upper domain generation process shows how we generate an error-free and logically correct PDDL domain, which involves reducing the search space by focusing LLMs on predicates and actions.
            We employ BoN sampling to consider multiple possible domain actions simultaneously.
            We then use verbalized machine learning to iteratively refine and improve the sampled domains in the text space.
            The downward planning blocks show how we generate the plan. 
           Once we have a synthetic PDDL domain that passes PDDL grammar checks, we combine it with a PDDL problem, then leverage searching algorithms such as  A$\ast$ to search for the optimal plan.</p>
        </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Solving complex planning problems requires Large Language Models (LLMs) to explicitly model the state transition to avoid rule violations, comply with constraints, and ensure optimality—a task hindered by the inherent ambiguity of natural language.
            To overcome such ambiguity, Planning Domain Definition Language (PDDL) is leveraged as a planning abstraction that enables precise and formal state descriptions. With PDDL, we can generate a symbolic world model where classic searching algorithms, such as A$\ast$, can be seamlessly used to find optimal plans. 
            However, directly generating PDDL domains with current LLMs remains an open challenge due to the lack of PDDL training data.
            To address this challenge, we propose to scale up the test-time computation of LLMs to enhance their PDDL reasoning capabilities, thereby enabling the generation of high-quality PDDL domains. Specifically, we introduce a simple yet effective algorithm, which first employs a Best-of-N sampling approach to improve quality of the initial solution and then refines the solution in a fine-grained manner with verbalized machine learning.
            Our method outperforms o1-mini by a considerable margin in PDDL domain generation, achieving over 50\% success rate on two tasks (\ie, generating PDDL domains from natural language description or PDDL problems). This is done without requiring additional training.
            By taking advantage of PDDL as state abstraction, our method is able to outperform current state-of-the-art methods on almost all the competition-level planning tasks. 
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <table>
      <caption>Comparison of the performance on PDDL Domain synthesis.</caption>
      <thead>
          <tr>
              <th>Model</th>
              <th># Params</th>
              <th>NL2Domain</th>
              <th>Problem2Domain</th>
              <th>Avg.</th>
          </tr>
      </thead>
      <tbody>
          <tr>
              <td colspan="5"><em>Open-Source Models</em></td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>0.5B</td>
              <td>0.0</td>
              <td>0.0</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>1.5B</td>
              <td>0.0</td>
              <td>0.0</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>3B</td>
              <td>2.1</td>
              <td>1.5</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>7B</td>
              <td>5.7</td>
              <td>11.7</td>
              <td>8.7</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>14B</td>
              <td>21.6</td>
              <td>25.3</td>
              <td>23.5</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>32B</td>
              <td>24.0</td>
              <td>31.6</td>
              <td>27.8</td>
          </tr>
          <tr>
              <td>Qwen2.5-Instruct</td>
              <td>72B</td>
              <td>38.5</td>
              <td>32.8</td>
              <td>35.7</td>
          </tr>
          <tr>
              <td>Qwen2.5-Coder</td>
              <td>1.5B</td>
              <td>0.0</td>
              <td>0.0</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>Qwen2.5-Coder</td>
              <td>7B</td>
              <td>21.9</td>
              <td>18.4</td>
              <td>20.2</td>
          </tr>
          <tr>
              <td colspan="5"><em>Closed-Source Models</em></td>
          </tr>
          <tr>
              <td>GPT-4o</td>
              <td>-</td>
              <td>5.3</td>
              <td>50.0</td>
              <td>27.7</td>
          </tr>
          <tr>
              <td>o1-mini</td>
              <td>-</td>
              <td>41.7</td>
              <td>33.7</td>
              <td>37.7</td>
          </tr>
          <tr>
              <td>o1-preview</td>
              <td>-</td>
              <td>55.8</td>
              <td>52.4</td>
              <td>54.1</td>
          </tr>
          <tr>
              <td colspan="5"><em>Our Methods</em></td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>0.5B</td>
              <td>0.0 (+0.0)</td>
              <td>0.0 (+0.0)</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>1.5B</td>
              <td>2.1 (+2.1)</td>
              <td>0.3 (+0.3)</td>
              <td>1.2</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>3B</td>
              <td>11.7 (+9.5)</td>
              <td>1.2 (+0.3)</td>
              <td>6.5</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>7B</td>
              <td>9.2 (+3.5)</td>
              <td>34.6 (+22.9)</td>
              <td>21.9</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>14B</td>
              <td>51.6 (+30.0)</td>
              <td>62.0 (+36.7)</td>
              <td>56.8</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instrcut</td>
              <td>32B</td>
              <td>66.8 (+46.7)</td>
              <td>71.1 (+39.5)</td>
              <td>70.9</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Instruct</td>
              <td>72B</td>
              <td>60.8 (+22.3)</td>
              <td>73.8 (+41.0)</td>
              <td>67.3</td>
          </tr>
          <tr>
              <td>BoN-8-Qwen2.5-Coder</td>
              <td>7B</td>
              <td>73.1 (+51.2)</td>
              <td>63.3 (+44.9)</td>
              <td>68.2</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>0.5B</td>
              <td>0.0 (+0.0)</td>
              <td>0.0 (+0.0)</td>
              <td>0.0</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>1.5B</td>
              <td>2.8 (+2.8)</td>
              <td>0.3 (+0.3)</td>
              <td>1.6</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>3B</td>
              <td>18.7 (+16.6)</td>
              <td>1.8 (+0.3)</td>
              <td>10.3</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>7B</td>
              <td>21.9 (+16.2)</td>
              <td>49.1 (+37.3)</td>
              <td>35.5</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>14B</td>
              <td>77.0 (+55.4)</td>
              <td>80.4 (+55.1)</td>
              <td>78.7</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>32B</td>
              <td>86.2 (+62.2)</td>
              <td>90.9 (+59.3)</td>
              <td>88.6</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Instruct</td>
              <td>72B</td>
              <td>78.4 (+39.9)</td>
              <td>86.4 (+53.6)</td>
              <td>82.4</td>
          </tr>
          <tr>
              <td>VML-5-BoN-8-Qwen2.5-Coder</td>
              <td>7B</td>
              <td>85.2 (+63.3)</td>
              <td>71.4 (+53.0)</td>
              <td>78.3</td>
          </tr>
      </tbody>
  </table>
  
    <!-- Concurrent Work. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work that was introduced around the same time as ours.
          </p>
          <p>
            <a href="https://arxiv.org/abs/2104.09125">Progressive Encoding for Neural Optimization</a> introduces an idea similar to our windowed position encoding for coarse-to-fine optimization.
          </p>
          <p>
            <a href="https://www.albertpumarola.com/research/D-NeRF/index.html">D-NeRF</a> and <a href="https://gvv.mpi-inf.mpg.de/projects/nonrigid_nerf/">NR-NeRF</a>
            both use deformation fields to model non-rigid scenes.
          </p>
          <p>
            Some works model videos with a NeRF by directly modulating the density, such as <a href="https://video-nerf.github.io/">Video-NeRF</a>, <a href="https://www.cs.cornell.edu/~zl548/NSFF/">NSFF</a>, and <a href="https://neural-3d-video.github.io/">DyNeRF</a>
          </p>
          <p>
            There are probably many more by the time you are reading this. Check out <a href="https://dellaert.github.io/NeRF/">Frank Dellart's survey on recent NeRF papers</a>, and <a href="https://github.com/yenchenlin/awesome-NeRF">Yen-Chen Lin's curated list of NeRF papers</a>.
          </p>
        </div>
      </div>
    </div>
    <!--/ Concurrent Work. -->

  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            The website is based on <a
              href="https://github.com/nerfies/nerfies.github.io">nerfies</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
